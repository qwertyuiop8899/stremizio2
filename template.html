<!DOCTYPE html>
<html lang="it">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="shortcut icon" type="image/png" href="logo.png">
    <title>IlCorsaroViola | Configurazione</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            background: #0a0515;
            position: relative;
            margin: 0;
            padding: 0;
        }
        
        /* Three.js container */
        #container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            touch-action: none;
            pointer-events: none;
        }
        
        #container canvas {
            pointer-events: none;
        }
        
        /* Remove old elements */
        #canvas-bg, #stars-container {
            display: none;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            background: #0a0515;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
            pointer-events: auto;
        }
        
        /* Make all interactive elements clickable */
        input, button, a, label {
            pointer-events: auto;
        }
        
        /* Header Section */
        .header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
            gap: 30px;
        }
        
        .logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            box-shadow: 0 8px 32px rgba(138, 43, 226, 0.4);
        }
        
        .brand h1 {
            font-size: 4.5em;
            font-weight: 700;
            background: linear-gradient(90deg, 
                #ffffff 0%, 
                #e0b3ff 20%, 
                #9333ea 40%, 
                #9333ea 60%, 
                #e0b3ff 80%, 
                #ffffff 100%);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
            text-align: center;
            animation: waveColor 3s ease-in-out infinite;
        }
        
        @keyframes waveColor {
            0% {
                background-position: 0% 0%;
            }
            50% {
                background-position: 100% 0%;
            }
            100% {
                background-position: 0% 0%;
            }
        }
        
        .header-left {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 30px;
            justify-content: center;
        }
        
        .header-left .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .prisonmike-img {
            width: 60px;
            height: auto;
            opacity: 0.9;
            transition: transform 0.3s ease;
            align-self: center;
        }
        
        .prisonmike-img:hover {
            transform: scale(1.1);
        }
        
        .header-right {
            width: 100%;
            max-width: 1200px;
        }
        
        .features-box {
            background: rgba(20, 20, 40, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 12px;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .features-box h4 {
            color: #c084fc;
            margin-bottom: 8px;
            font-size: 1em;
            grid-column: span 1;
        }
        
        .features-box ul {
            list-style: none;
            padding: 0;
            grid-column: span 1;
        }
        
        .features-box li {
            color: #d1d5db;
            margin-bottom: 6px;
            font-size: 0.9em;
            padding-left: 18px;
            position: relative;
        }
        
        .features-box li::before {
            content: '‚ú¶';
            position: absolute;
            left: 0;
            color: #9333ea;
        }
        
        .config-info {
            background: rgba(147, 51, 234, 0.2);
            border: 1px solid rgba(147, 51, 234, 0.4);
            border-radius: 8px;
            padding: 15px;
            grid-column: span 1;
        }
        
        .config-info p {
            margin: 0;
            font-size: 0.9em;
            color: #e5e7eb;
        }
        
        #status {
            font-weight: 600;
            margin-top: 8px;
            font-size: 1em;
        }
        
        /* Main Grid Layout */
        .config-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 1024px) {
            .config-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .config-grid .full-width {
                grid-column: span 3;
            }
            
            .config-grid .half-width {
                grid-column: span 2;
            }
        }
        
        @media (min-width: 768px) and (max-width: 1023px) {
            .config-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .config-grid .full-width {
                grid-column: span 2;
            }
        }
        
        /* Service Cards */
        .service-card {
            background: rgba(20, 20, 40, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            pointer-events: auto;
        }
        }
        
        .service-card:hover {
            border-color: rgba(147, 51, 234, 0.6);
            box-shadow: 0 8px 32px rgba(147, 51, 234, 0.2);
        }
        
        .service-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .service-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3em;
            font-weight: 600;
            color: #c084fc;
        }
        
        .service-title a {
            color: #9333ea;
            text-decoration: none;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .service-title a:hover {
            opacity: 1;
        }
        
        .key-icon {
            font-size: 1em;
        }
        
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #9333ea;
        }
        
        input[type="text"], 
        input[type="password"],
        textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(10, 10, 26, 0.6);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 8px;
            color: #ffffff;
            font-size: 0.95em;
            transition: all 0.3s ease;
            margin-top: 8px;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #9333ea;
            box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.2);
        }
        
        input:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            user-select: none;
        }
        
        .search-sites {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
        }
        
        .search-sites label {
            background: rgba(10, 10, 26, 0.4);
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid rgba(147, 51, 234, 0.2);
            transition: all 0.3s;
        }
        
        .search-sites label:hover {
            border-color: rgba(147, 51, 234, 0.5);
            background: rgba(10, 10, 26, 0.6);
        }
        
        /* Action Section */
        .action-section {
            background: rgba(20, 20, 40, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 12px;
            padding: 35px;
            pointer-events: auto;
        }
        
        .button-group {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            flex: 1;
            min-width: 200px;
            padding: 18px 35px;
            background: linear-gradient(135deg, #9333ea 0%, #7c3aed 100%);
            color: #ffffff;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(147, 51, 234, 0.3);
        }
        
        button:hover:not(:disabled) {
            background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(147, 51, 234, 0.4);
        }
        
        button:active:not(:disabled) {
            transform: translateY(0);
        }
        
        button:disabled {
            background: rgba(100, 100, 120, 0.3);
            cursor: not-allowed;
            box-shadow: none;
        }
        
        #link-container {
            display: none;
        }
        
        #link-container.show {
            display: block;
        }
        
        textarea {
            width: 100%;
            min-height: 80px;
            resize: vertical;
            font-family: monospace;
            font-size: 1em;
            padding: 15px;
            background: rgba(10, 10, 26, 0.6);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 8px;
            color: #ffffff;
        }
        
        .section-title {
            color: #c084fc;
            font-size: 1.2em;
            margin-bottom: 15px;
            font-weight: 600;
            text-align: center;
        }
        
        small {
            color: #9ca3af;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/88/three.min.js"></script>
    <script id="vertexShader" type="x-shader/x-vertex">
        void main() {
            gl_Position = vec4( position, 1.0 );
        }
    </script>
    <script id="fragmentShader" type="x-shader/x-fragment">
        uniform vec2 u_resolution;
        uniform vec2 u_mouse;
        uniform float u_time;
        uniform sampler2D u_noise;
        
        #define PI 3.141592653589793
        #define TAU 6.283185307179586
        
        const float multiplier = 20.0;
        const float zoomSpeed = 15.;
        const float mouseRadius = 0.25;
        const float mouseStrength = 0.3;
        
        vec2 hash2(vec2 p) {
            vec2 o = texture2D(u_noise, (p+0.5)/256.0, -100.0).xy;
            return o;
        }
        
        void main() {
            vec2 uv = gl_FragCoord.xy / u_resolution.xy;
            uv = uv * 2. - 1.;
            uv.x *= u_resolution.x / u_resolution.y;
            
            vec3 color = vec3(0.05, 0.02, 0.1);
            
            float t = u_time * 0.1;
            
            // Convert mouse to same coordinate system as uv
            vec2 mouse = u_mouse * 2.0 - 1.0;
            mouse.x *= u_resolution.x / u_resolution.y;
            
            for(float i = 0.; i < 3.; i++) {
                vec2 uv2 = uv * (1.0 + i * 0.5);
                vec2 uv2_animated = uv2;
                uv2_animated.y += t * (0.3 + i * 0.1);
                
                vec2 hash = hash2(floor(uv2_animated * multiplier));
                vec2 offset = fract(uv2_animated * multiplier);
                
                // Mouse interaction using screen-space distance
                float distToMouse = length(uv - mouse);
                
                // Base particle color (purple)
                vec3 particleColor = vec3(0.5, 0.2, 0.8);
                
                if(distToMouse < mouseRadius) {
                    // Push AWAY from mouse (repel)
                    vec2 pushDir = normalize(uv - mouse);
                    float pushForce = (1.0 - distToMouse / mouseRadius) * mouseStrength;
                    offset += pushDir * pushForce * 3.0;
                    
                    // Change to yellow when near mouse
                    float colorMix = 1.0 - (distToMouse / mouseRadius);
                    particleColor = mix(vec3(0.5, 0.2, 0.8), vec3(1.0, 0.9, 0.2), colorMix);
                }
                
                float d = length(offset - hash);
                // Particles size: smaller but sharper
                float brightness = smoothstep(0.15, 0.0, d);
                
                // Add glow effect
                float glow = smoothstep(0.3, 0.0, d) * 0.3;
                
                color += particleColor * (brightness + glow) * (1.0 - i * 0.2);
            }
            
            gl_FragColor = vec4(color, 1.0);
        }
    </script>
</head>
<body>
    <div id="container"></div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <img src="prisonmike.png" alt="Prison Mike" class="prisonmike-img">
                
                <div class="logo-container">
                    <img src="logo.png" alt="Logo" class="logo">
                    <div class="brand" style="text-align: center;">
                        <h1 style="margin-bottom: 5px;">IlCorsaroViola</h1>
                        <small style="font-size: 12px; color: #9ca3af; display: block; line-height: 1.5;">
                            Addon creato partendo da <a href="https://stremizio.vercel.app/" target="_blank" style="color: #9333ea; text-decoration: none;">Stremizio 2.0</a>, grazie a 
                            <a href="https://github.com/StremioItalia/stremizio" target="_blank" style="color: #9333ea; text-decoration: none;">Steve</a>
                        </small>
                    </div>
                </div>
                
                <img src="prisonmike.png" alt="Prison Mike" class="prisonmike-img">
            </div>
            
            <div class="header-right">
                <div class="features-box">
                    <div style="grid-column: span 1;">
                        <h4>Caratteristiche principali:</h4>
                        <ul>
                            <li><strong>Multi-sorgente:</strong> Il Corsaro Nero (DB locale incrementale con Cache RD reale), UIndex, Knaben e Jackett (opzionale)</li>
                            <li><strong>Ottimizzato per l'Italia:</strong> Priorit√† ai contenuti in italiano üáÆüáπ</li>
                        </ul>
                    </div>
                    <div style="grid-column: span 1;">
                        <h4 style="visibility: hidden;">Placeholder</h4>
                        <ul>
                            <li><strong>Debrid:</strong> Real-Debrid, Torbox e/o AllDebrid per streaming istantaneo</li>
                            <li><strong>MediaFlow Proxy:</strong> Condividi Real-Debrid in sicurezza (opzionale)</li>
                            <li><strong>P2P Fallback:</strong> Senza debrid usa streaming P2P diretto</li>
                        </ul>
                    </div>
                </div>
                
                <div class="config-info">
                    <p style="text-align: center;">Configura i servizi che vuoi utilizzare:</p>
                    <div id="status" style="text-align: center;">‚úì Configurazione pronta (Solo P2P) | Siti: CorsaroNero, UIndex, Knaben</div>
                </div>
            </div>
        </div>
        
        <!-- Configuration Grid -->
        <div class="config-grid">
            <!-- Debrid Services Row -->
            <div class="service-card">
                <div class="service-header">
                    <div class="service-title">
                        üîµ Real-Debrid (Opzionale)
                        <a href="https://real-debrid.com/apitoken" target="_blank" title="Ottieni API Key">
                            <span class="key-icon">üîë</span>
                        </a>
                    </div>
                    <input type="checkbox" id="use_rd">
                </div>
                <input id="rd_key" placeholder="Real-Debrid API Key" type="password" disabled>
            </div>
            
            <div class="service-card">
                <div class="service-header">
                    <div class="service-title">
                        üì¶ Torbox (Opzionale)
                        <a href="https://torbox.app/settings" target="_blank" title="Ottieni API Key">
                            <span class="key-icon">üîë</span>
                        </a>
                    </div>
                    <input type="checkbox" id="use_torbox">
                </div>
                <input id="torbox_key" placeholder="Torbox API Key" type="password" disabled>
            </div>
            
            <div class="service-card">
                <div class="service-header">
                    <div class="service-title">
                        üÖ∞Ô∏è AllDebrid (Opzionale)
                        <a href="https://alldebrid.com/apikeys/" target="_blank" title="Ottieni API Key">
                            <span class="key-icon">üîë</span>
                        </a>
                    </div>
                    <input type="checkbox" id="use_alldebrid">
                </div>
                <input id="alldebrid_key" placeholder="AllDebrid API Key" type="password" disabled>
            </div>
            
            <!-- MediaFlow and Jackett Row -->
            <div class="service-card">
                <div class="service-header">
                    <div class="service-title">üîÄ MediaFlow Proxy (Opzionale - Solo per RD)</div>
                </div>
                <small>Per condividere Real-Debrid tra pi√π utenti</small>
                <input id="mediaflow_url" placeholder="MediaFlow URL (es: https://your-mfp.com)" type="text">
                <input id="mediaflow_password" placeholder="MediaFlow Password" type="password">
            </div>
            
            <div class="service-card">
                <div class="service-header">
                    <div class="service-title">üîç Jackett Configuration (Opzionale - Solo Italiani)</div>
                </div>
                <small>Cerca su indexer configurati (solo risultati italiani üáÆüáπ)</small>
                <input id="jackett_url" placeholder="Jackett URL (es: https://jackett.your-domain.com)" type="text">
                <input id="jackett_api_key" placeholder="Jackett API Key" type="password">
                <input id="jackett_password" placeholder="Jackett Password (opzionale)" type="password">
            </div>
            
            <!-- Search Sites and Action Section Row -->
            <div class="service-card">
                <div class="section-title">üîé Siti di Ricerca Torrent</div>
                <small>Seleziona su quali siti cercare i torrent:</small>
                <div class="search-sites">
                    <label>
                        <input type="checkbox" id="use_corsaronero" checked>
                        <span>üè¥‚Äç‚ò†Ô∏è Il Corsaro Nero (Italiano)</span>
                    </label>
                    <label>
                        <input type="checkbox" id="use_uindex" checked>
                        <span>üìö UIndex (Internazionale)</span>
                    </label>
                    <label>
                        <input type="checkbox" id="use_knaben" checked>
                        <span>ü¶â Knaben (Internazionale)</span>
                    </label>
                </div>
            </div>
            
            <div class="action-section full-width">
                <div class="button-group">
                    <button id="install_button" disabled>Installa Addon</button>
                    <button id="copy_button" disabled>Copia Link</button>
                </div>
                
                <div id="link-container">
                    <p class="section-title"><small>Link di installazione generato:</small></p>
                    <textarea id="install_link_display" rows="3" readonly></textarea>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Input fields
        const useRdCheckbox = document.getElementById("use_rd");
        const rdKeyInput = document.getElementById("rd_key");
        const useTorboxCheckbox = document.getElementById("use_torbox");
        const torboxKeyInput = document.getElementById("torbox_key");
        const useAllDebridCheckbox = document.getElementById("use_alldebrid");
        const allDebridKeyInput = document.getElementById("alldebrid_key");
        const mediaflowUrlInput = document.getElementById("mediaflow_url");
        const mediaflowPasswordInput = document.getElementById("mediaflow_password");
        const jackettUrlInput = document.getElementById("jackett_url");
        const jackettApiKeyInput = document.getElementById("jackett_api_key");
        const jackettPasswordInput = document.getElementById("jackett_password");
        
        // Checkboxes for search sites
        const useCorsaroNeroCheckbox = document.getElementById("use_corsaronero");
        const useUIndexCheckbox = document.getElementById("use_uindex");
        const useKnabenCheckbox = document.getElementById("use_knaben");
        
        // Buttons
        const installButton = document.getElementById("install_button");
        const copyButton = document.getElementById("copy_button");
        const statusEl = document.getElementById("status");
        const linkContainer = document.getElementById("link-container");
        const installLinkDisplay = document.getElementById("install_link_display");

        // Enable/disable RD input based on checkbox
        useRdCheckbox.addEventListener('change', () => {
            rdKeyInput.disabled = !useRdCheckbox.checked;
            if (!useRdCheckbox.checked) rdKeyInput.value = '';
            updateInstallLink();
        });

        // Enable/disable Torbox input based on checkbox
        useTorboxCheckbox.addEventListener('change', () => {
            torboxKeyInput.disabled = !useTorboxCheckbox.checked;
            if (!useTorboxCheckbox.checked) torboxKeyInput.value = '';
            updateInstallLink();
        });

        // Enable/disable AllDebrid input based on checkbox
        useAllDebridCheckbox.addEventListener('change', () => {
            allDebridKeyInput.disabled = !useAllDebridCheckbox.checked;
            if (!useAllDebridCheckbox.checked) allDebridKeyInput.value = '';
            updateInstallLink();
        });

        function updateInstallLink() {
            // TMDB is now hardcoded, no validation needed
            const tmdbKey = '5462f78469f3d80bf5201645294c16e4';

            // Build config object (TMDB always included)
            const config = { tmdb_key: tmdbKey };
            
            // Real-Debrid
            if (useRdCheckbox.checked) {
                const rdKey = rdKeyInput.value.trim();
                if (rdKey) {
                    config.use_rd = true;
                    config.rd_key = rdKey;
                }
            }
            
            // Torbox
            if (useTorboxCheckbox.checked) {
                const torboxKey = torboxKeyInput.value.trim();
                if (torboxKey) {
                    config.use_torbox = true;
                    config.torbox_key = torboxKey;
                }
            }
            
            // AllDebrid
            if (useAllDebridCheckbox.checked) {
                const allDebridKey = allDebridKeyInput.value.trim();
                if (allDebridKey) {
                    config.use_alldebrid = true;
                    config.alldebrid_key = allDebridKey;
                }
            }
            
            // MediaFlow Proxy
            const mediaflowUrl = mediaflowUrlInput.value.trim();
            const mediaflowPassword = mediaflowPasswordInput.value.trim();
            if (mediaflowUrl && mediaflowPassword) {
                config.mediaflow_url = mediaflowUrl;
                config.mediaflow_password = mediaflowPassword;
            }
            
            // Jackettio
            const jackettUrl = jackettUrlInput.value.trim();
            const jackettApiKey = jackettApiKeyInput.value.trim();
            if (jackettUrl && jackettApiKey) {
                config.jackett_url = jackettUrl;
                config.jackett_api_key = jackettApiKey;
                
                const jackettPassword = jackettPasswordInput.value.trim();
                if (jackettPassword) {
                    config.jackett_password = jackettPassword;
                }
            }
            
            // Search sites selection
            config.use_corsaronero = useCorsaroNeroCheckbox.checked;
            config.use_uindex = useUIndexCheckbox.checked;
            config.use_knaben = useKnabenCheckbox.checked;
            
            // Check if at least one search site is selected
            let searchSites = [];
            if (config.use_corsaronero) searchSites.push("CorsaroNero");
            if (config.use_uindex) searchSites.push("UIndex");
            if (config.use_knaben) searchSites.push("Knaben");
            
            if (searchSites.length === 0) {
                // No search sites selected - show error
                statusEl.textContent = "‚ùå Seleziona almeno un sito per la ricerca";
                statusEl.style.color = '#FF6B6B';
                linkContainer.classList.remove('show');
                installButton.disabled = true;
                copyButton.disabled = true;
                return;
            }
            
            // Generate install URL
            const encodedConfig = btoa(JSON.stringify(config));
            const installUrl = `stremio://${window.location.host}/${encodedConfig}/manifest.json`;
            
            installLinkDisplay.value = installUrl;
            linkContainer.classList.add('show');
            installButton.disabled = false;
            copyButton.disabled = false;
            
            // Status message
            let services = [];
            if (config.use_rd) services.push("Real-Debrid");
            if (config.use_torbox) services.push("Torbox");
            if (config.use_alldebrid) services.push("AllDebrid");
            if (config.mediaflow_url) services.push("MediaFlow");
            if (config.jackett_url) services.push("Jackettio");
            
            const serviceText = services.length > 0 ? ` (${services.join(', ')})` : ' (Solo P2P)';
            const searchText = ` | Siti: ${searchSites.join(', ')}`;
            statusEl.textContent = `‚úì Configurazione pronta${serviceText}${searchText}`;
            statusEl.style.color = '#4EC9B0';
        }

        // Event listeners for all inputs
        rdKeyInput.addEventListener('input', updateInstallLink);
        torboxKeyInput.addEventListener('input', updateInstallLink);
        allDebridKeyInput.addEventListener('input', updateInstallLink);
        mediaflowUrlInput.addEventListener('input', updateInstallLink);
        mediaflowPasswordInput.addEventListener('input', updateInstallLink);
        jackettUrlInput.addEventListener('input', updateInstallLink);
        jackettApiKeyInput.addEventListener('input', updateInstallLink);
        jackettPasswordInput.addEventListener('input', updateInstallLink);
        
        // Event listeners for search site checkboxes
        useCorsaroNeroCheckbox.addEventListener('change', updateInstallLink);
        useUIndexCheckbox.addEventListener('change', updateInstallLink);
        useKnabenCheckbox.addEventListener('change', updateInstallLink);
        
        // Initial call to enable buttons
        updateInstallLink();

        installButton.addEventListener('click', () => {
            if (installLinkDisplay.value) window.location.href = installLinkDisplay.value;
        });

        copyButton.addEventListener('click', () => {
            if (installLinkDisplay.value) {
                navigator.clipboard.writeText(installLinkDisplay.value).then(() => {
                    const originalText = statusEl.textContent;
                    statusEl.textContent = "‚úì Link copiato negli appunti!";
                    statusEl.style.color = '#4EC9B0';
                    const btnText = copyButton.textContent;
                    copyButton.textContent = "Copiato!";
                    setTimeout(() => {
                        copyButton.textContent = btnText;
                        statusEl.textContent = originalText;
                    }, 2000);
                });
            }
        });
    </script>
    <script>
        // Ashfall Three.js effect
        let container;
        let camera, scene, renderer;
        let uniforms;
        let loader = new THREE.TextureLoader();
        let texture;
        
        loader.setCrossOrigin("anonymous");
        loader.load(
            'https://s3-us-west-2.amazonaws.com/s.cdpn.io/982762/noise.png',
            function(tex) {
                texture = tex;
                texture.wrapS = THREE.RepeatWrapping;
                texture.wrapT = THREE.RepeatWrapping;
                texture.minFilter = THREE.LinearFilter;
                init();
                animate();
            }
        );

        function init() {
            container = document.getElementById('container');

            camera = new THREE.Camera();
            camera.position.z = 1;

            scene = new THREE.Scene();

            var geometry = new THREE.PlaneBufferGeometry(2, 2);

            uniforms = {
                u_time: { type: "f", value: 1.0 },
                u_resolution: { type: "v2", value: new THREE.Vector2() },
                u_noise: { type: "t", value: texture },
                u_mouse: { type: "v2", value: new THREE.Vector2() }
            };

            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: document.getElementById('vertexShader').textContent,
                fragmentShader: document.getElementById('fragmentShader').textContent
            });

            var mesh = new THREE.Mesh(geometry, material);
            scene.add(mesh);

            renderer = new THREE.WebGLRenderer();
            renderer.setPixelRatio(window.devicePixelRatio);

            container.appendChild(renderer.domElement);

            onWindowResize();
            window.addEventListener('resize', onWindowResize, false);

            document.addEventListener('mousemove', function(e) {
                uniforms.u_mouse.value.x = e.clientX / window.innerWidth;
                uniforms.u_mouse.value.y = 1.0 - (e.clientY / window.innerHeight);
            });
        }

        function onWindowResize() {
            renderer.setSize(window.innerWidth, window.innerHeight);
            uniforms.u_resolution.value.x = renderer.domElement.width;
            uniforms.u_resolution.value.y = renderer.domElement.height;
        }

        function animate(time) {
            requestAnimationFrame(animate);
            uniforms.u_time.value = time * 0.001;
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
